{"ast":null,"code":"import _slicedToArray from\"/Users/nicolaspisar/Sites/_OClock/react/Apo/projet-9-sound-clock-front/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";// == IMPORT NPM\nimport React,{useEffect}from'react';import{useParams,useLocation}from\"react-router-dom\";import{Icon}from\"semantic-ui-react\";import{useSelector,useDispatch}from\"react-redux\";// == IMPORT ASSETS\nimport ModalAddMusic from\"./ModalAddMusic\";import ModalUpdateProfile from\"./ModalUpdateProfile\";import{sendMusic,setMusicField}from'../../actions/musics';import{updateProfile,setUserField,getUserWithSlug}from'../../actions/user';import Music from\"../Cards/Music\";import Playlist from\"../Cards/Playlist\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var User=function User(_ref){var avatar=_ref.avatar,baseApiUrl=_ref.baseApiUrl;var _React$useState=React.useState(false),_React$useState2=_slicedToArray(_React$useState,2),open=_React$useState2[0],setOpen=_React$useState2[1];var dispatch=useDispatch();var location=useLocation();var userLoaded=useSelector(function(state){return state.users.userLoaded;});var showModals;//* useParams used to pickup the slug is the user is not logged\nvar _useParams=useParams(),slug=_useParams.slug;useEffect(function(){dispatch(getUserWithSlug(slug));window.scrollTo(0,0);},[dispatch,location,slug]);//* Logged status retrieval\nvar logged=useSelector(function(state){return state.users.logged;});//* Modal State values for controled fields\nvar modalTitle=useSelector(function(state){return state.musics.title;});var modalFile=useSelector(function(state){return state.musics.file;});var modalPicture=useSelector(function(state){return state.musics.picture;});var modalReleaseDate=useSelector(function(state){return state.musics.releaseDate;});var modalDescription=useSelector(function(state){return state.musics.description;});var progressUpload=useSelector(function(state){return state.musics.progress;});var errorCode=useSelector(function(state){return state.musics.errorCode;});var updateUserEmail=useSelector(function(state){return state.users.email;});var updateUserDescription=useSelector(function(state){return state.users.description;});var updateUserPassword=useSelector(function(state){return state.users.password;});var updateUserPicutre=useSelector(function(state){return state.users.picture.name;});var updateUserLabel=useSelector(function(state){return state.users.label;});var updateUserStatus=useSelector(function(state){return state.users.errorCodeMail;});//* declaring userData variable\nvar userData;//* clicked User data\nvar clickedUser=useSelector(function(state){return state.users.clickedUser;});// console.log('je suis sur la page user, je suis la valuer du clockedUser : ', clickedUser);\n//* logged in User data\nvar loggedUser=useSelector(function(state){return state.users.user;});//console.log('je suis sur la page user, je suis la valuer du loggedUser : ', loggedUser);\n// const usersList = useSelector((state) => state.users.list);\n// console.log('je suis sur la page user, voici la liste de user:' , usersList);\n//* User Data retreival from the state\nif(clickedUser){userData=clickedUser;// console.log(' je suis le user data du clicked user : ', userData);\n}else{userData=loggedUser;//console.log(' je suis le user data du logged user : ', userData);\n}if(loggedUser.slug===clickedUser.slug){showModals=true;}var changeField=function changeField(value,name){//console.log(`Je veux modifier le champ ${name} avec la valeur ${value}`);\ndispatch(setUserField(value,name));};var changeMusicField=function changeMusicField(value,name){//console.log(`Je veux modifier le champ ${name} avec la valeur ${value}`);\ndispatch(setMusicField(value,name));};var handleAddMusic=function handleAddMusic(dateValue){// console.log('Je veux me logger (au moins essayer)');\ndispatch(sendMusic(dateValue));};var handleUpdateProfile=function handleUpdateProfile(dateValue){// console.log('Je veux me logger (au moins essayer)');\ndispatch(updateProfile(dateValue));};//TODO Picking up the musics results for the user from the user musics API\nvar musics=userData.musics;var playlists=userData.playlists;var certificationIcon=/*#__PURE__*/_jsx(Icon,{name:\"certificate\",size:\"tiny\",className:\"card__content--h1-cert\"});return/*#__PURE__*/_jsxs(\"div\",{className:\"user-wrapper\",children:[/*#__PURE__*/_jsxs(\"section\",{className:\"user-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"user__avatar--container\",children:[!logged&&!slug&&/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"div\",{className:\"user__avatar\",style:{\"backgroundImage\":\"url(\".concat(avatar,\")\")}})}),(logged||slug)&&/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"div\",{className:\"user__avatar\",style:{\"backgroundImage\":\"url(\".concat(baseApiUrl,\"/\").concat(userData.picture,\")\")}})}),showModals&&/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"div\",{className:\"user__modifyUser--container\",children:/*#__PURE__*/_jsx(ModalUpdateProfile,{description:updateUserDescription,email:updateUserEmail,passwrod:updateUserPassword,picture:updateUserPicutre,label:updateUserLabel,changeField:changeField,userData:userData,handleUpdateProfile:handleUpdateProfile,progress:progressUpload,errorCode:updateUserStatus,open:open,setOpen:setOpen})})})]}),/*#__PURE__*/_jsxs(\"section\",{className:\"user__header-container\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[!logged&&!slug&&/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"h1\",{className:\"user__header--name-noUser\",children:\"Aucun utilisateur trouv\\xE9.\"})}),logged&&!slug&&/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"h1\",{className:\"user__header--name\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"user__header--welcome\",children:\"Bienvenue\"}),\" \",userData.name,userData.certification&&certificationIcon]})}),logged&&slug&&/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"h1\",{className:\"user__header--name\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"user__header--welcome\",children:\"Bienvenue\"}),\" \",userData.name,userData.certification&&certificationIcon]})}),!logged&&slug&&/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"h1\",{className:\"user__header--name\",children:[\"Bienvenue \",slug,userData.certification&&certificationIcon]})}),(logged||slug)&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"user__header--link\",children:[\"http://wwww.soundclock.com/\",logged&&userData.name,!logged&&slug]}),/*#__PURE__*/_jsx(\"div\",{className:\"user__header--email\",children:logged&&userData.email}),/*#__PURE__*/_jsxs(\"div\",{className:\"user__header--data-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"user__header-h2\",children:[\"Abonn\\xE9s:\",/*#__PURE__*/_jsx(\"span\",{className:\"user__header-h2--stats\",children:userLoaded&&userData.subscribers.length})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"user__header-h2\",children:[\"Musiques:\",/*#__PURE__*/_jsx(\"span\",{className:\"user__header-h2--stats\",children:userLoaded&&userData.musics.length})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"user__header-h2\",children:[\"Label:\",/*#__PURE__*/_jsx(\"span\",{className:\"user__header-h2--stats\",children:userData.label})]})]})]})]}),(logged||slug)&&/*#__PURE__*/_jsx(\"div\",{className:\"user__description\",children:userData.description})]})]}),/*#__PURE__*/_jsxs(\"section\",{className:\"content-container\",children:[showModals&&/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"div\",{className:\"content__addMusic--container\",children:/*#__PURE__*/_jsx(ModalAddMusic,{title:modalTitle,file:modalFile,picture:modalPicture,releaseDate:modalReleaseDate,description:modalDescription,changeMusicField:changeMusicField,handleAddMusic:handleAddMusic,progress:progressUpload,errorCode:errorCode})})}),/*#__PURE__*/_jsx(\"h1\",{className:\"content__section--title\",children:\"Music\"}),/*#__PURE__*/_jsx(\"div\",{className:\"content__section--container\",children:userLoaded&&/*#__PURE__*/_jsx(_Fragment,{children:musics.map(function(music){return/*#__PURE__*/_jsx(Music,{name:music.title,date:music.releaseDate,image:music.picture,description:music.description,song:music.file,nbLike:music.nbLike,nbListened:music.nbListened,baseApiUrl:baseApiUrl},music.id);})})}),/*#__PURE__*/_jsx(\"div\",{className:\"content__section-container__placeholder\"}),/*#__PURE__*/_jsx(\"h1\",{className:\"content__section--title\",children:\"Playlists\"}),/*#__PURE__*/_jsx(\"div\",{className:\"content__section--container content__section--container-playlist\",children:userLoaded&&/*#__PURE__*/_jsx(_Fragment,{children:playlists.map(function(playlist){return/*#__PURE__*/_jsx(Playlist,{name:playlist.title,date:playlist.createdAt,image:playlist.picture,description:playlist.description,nbLike:playlist.nbLike,baseApiUrl:baseApiUrl},playlist.id);})})}),/*#__PURE__*/_jsx(\"div\",{className:\"content__section-container__placeholder\"})]})]});};export default User;","map":{"version":3,"sources":["/Users/nicolaspisar/Sites/_OClock/react/Apo/projet-9-sound-clock-front/src/components/User/index.js"],"names":["React","useEffect","useParams","useLocation","Icon","useSelector","useDispatch","ModalAddMusic","ModalUpdateProfile","sendMusic","setMusicField","updateProfile","setUserField","getUserWithSlug","Music","Playlist","User","avatar","baseApiUrl","useState","open","setOpen","dispatch","location","userLoaded","state","users","showModals","slug","window","scrollTo","logged","modalTitle","musics","title","modalFile","file","modalPicture","picture","modalReleaseDate","releaseDate","modalDescription","description","progressUpload","progress","errorCode","updateUserEmail","email","updateUserDescription","updateUserPassword","password","updateUserPicutre","name","updateUserLabel","label","updateUserStatus","errorCodeMail","userData","clickedUser","loggedUser","user","changeField","value","changeMusicField","handleAddMusic","dateValue","handleUpdateProfile","playlists","certificationIcon","certification","subscribers","length","map","music","nbLike","nbListened","id","playlist","createdAt"],"mappings":"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","sourcesContent":["// == IMPORT NPM\nimport React, { useEffect} from 'react';\nimport { useParams, useLocation } from \"react-router-dom\";\nimport PropTypes from \"prop-types\";\nimport { Icon } from \"semantic-ui-react\";\nimport { useSelector, useDispatch } from \"react-redux\";\n\n\n// == IMPORT ASSETS\nimport ModalAddMusic from \"./ModalAddMusic\";\nimport ModalUpdateProfile from \"./ModalUpdateProfile\";\nimport { sendMusic, setMusicField } from '../../actions/musics';\nimport { updateProfile, setUserField, getUserWithSlug } from '../../actions/user';\nimport Music from \"../Cards/Music\";\nimport Playlist from \"../Cards/Playlist\";\n\nconst User = ( { avatar, baseApiUrl }) => { \n  \n  const [open, setOpen] = React.useState(false);\n\n  const dispatch = useDispatch();\n  const location = useLocation();\n  const userLoaded = useSelector((state) => state.users.userLoaded); \n  let showModals;\n\n  //* useParams used to pickup the slug is the user is not logged\n  const { slug } = useParams();\n  useEffect(\n    () => {\n      dispatch(getUserWithSlug(slug));\n      window.scrollTo(0, 0);\n    }, [dispatch, location, slug]\n  );\n\n  //* Logged status retrieval\n  const logged = useSelector((state) => state.users.logged);\n\n  //* Modal State values for controled fields\n  const modalTitle = useSelector((state) => state.musics.title);\n  const modalFile = useSelector((state) => state.musics.file);\n  const modalPicture = useSelector((state) => state.musics.picture);\n  const modalReleaseDate = useSelector((state) => state.musics.releaseDate);\n  const modalDescription = useSelector((state) => state.musics.description);\n  const progressUpload = useSelector((state) => state.musics.progress );\n  const errorCode = useSelector((state) => state.musics.errorCode);\n\n  const updateUserEmail = useSelector((state) => state.users.email);\n  const updateUserDescription = useSelector((state) => state.users.description);\n  const updateUserPassword = useSelector((state) => state.users.password);\n  const updateUserPicutre = useSelector((state) => state.users.picture.name);\n  const updateUserLabel = useSelector((state) => state.users.label);\n  const updateUserStatus = useSelector((state) => state.users.errorCodeMail);\n  \n  //* declaring userData variable\n  let userData;\n\n  //* clicked User data\n  const clickedUser  =  useSelector((state) => state.users.clickedUser);\n  // console.log('je suis sur la page user, je suis la valuer du clockedUser : ', clickedUser);\n  //* logged in User data\n  const loggedUser = useSelector((state) => state.users.user);\n  //console.log('je suis sur la page user, je suis la valuer du loggedUser : ', loggedUser);\n\n  // const usersList = useSelector((state) => state.users.list);\n  // console.log('je suis sur la page user, voici la liste de user:' , usersList);\n\n  //* User Data retreival from the state\n  if((clickedUser)){\n    userData = clickedUser;\n    // console.log(' je suis le user data du clicked user : ', userData);\n  } else {\n    userData = loggedUser;\n    //console.log(' je suis le user data du logged user : ', userData);\n  }\n\n  if(loggedUser.slug === clickedUser.slug){\n    showModals = true;\n  }\n\n  const changeField = (value, name) => {\n    //console.log(`Je veux modifier le champ ${name} avec la valeur ${value}`);\n    dispatch(setUserField(value, name));\n  };\n\n  const changeMusicField = (value, name) => {\n    //console.log(`Je veux modifier le champ ${name} avec la valeur ${value}`);\n    dispatch(setMusicField(value, name));\n  };\n\n  const handleAddMusic = (dateValue) => {\n    // console.log('Je veux me logger (au moins essayer)');\n    dispatch(sendMusic(dateValue));\n  };\n\n  const handleUpdateProfile = (dateValue) => {\n    // console.log('Je veux me logger (au moins essayer)');\n    dispatch(updateProfile(dateValue));\n  };\n  \n  //TODO Picking up the musics results for the user from the user musics API\n  const musics = userData.musics;\n  const playlists = userData.playlists;\n\n  const certificationIcon = <Icon name='certificate' size='tiny' className='card__content--h1-cert' />;\n  return (\n    \n    <div className=\"user-wrapper\">\n\n    <section className=\"user-container\">\n\n      <div className=\"user__avatar--container\">\n      \n      {/* //* Conditional view for avater if not logged or no slug selected */}\n        {((!logged) && (!slug)) && (\n          <>\n          <div className=\"user__avatar\" style={{\"backgroundImage\": `url(${avatar})` }}></div>\n          </>\n        )}\n      {/* //* Conditional view for avater if logged or slug available */}\n        {((logged) || (slug)) && (\n          <>\n          <div className=\"user__avatar\" style={{\"backgroundImage\": `url(${baseApiUrl}/${userData.picture})` }}></div>\n          </>\n        )}    \n\n        {/* Modal to modifythe user data */}\n        { showModals &&\n        <>\n          <div className=\"user__modifyUser--container\">\n            <ModalUpdateProfile \n              description={updateUserDescription}\n              email={updateUserEmail}\n              passwrod={updateUserPassword}\n              picture={updateUserPicutre}\n              label={updateUserLabel}\n              changeField={changeField}\n              userData={userData}\n              handleUpdateProfile={handleUpdateProfile}\n              progress = {progressUpload}\n              errorCode= {updateUserStatus}\n              open={open}\n              setOpen={setOpen}\n            />     \n          </div>\n        </>\n        }\n      </div>\n\n      <section className=\"user__header-container\">\n        \n        <div>\n          {(!logged) && (!slug) && (\n            <>\n            <h1 className=\"user__header--name-noUser\">Aucun utilisateur trouvé.</h1>\n            </>\n          )}\n          {((logged) && (!slug)) && (\n            <>\n            <h1 className=\"user__header--name\"><span className='user__header--welcome'>Bienvenue</span> {userData.name}\n            {(userData.certification) && certificationIcon }\n            </h1>\n            </>\n          )} \n          {((logged) && (slug)) && (\n            <>\n            <h1 className=\"user__header--name\"><span className='user__header--welcome'>Bienvenue</span> {userData.name}\n            {(userData.certification) && certificationIcon }\n            </h1>\n            </>\n          )} \n          {((!logged) && (slug)) && (\n            <>\n            <h1 className=\"user__header--name\">Bienvenue {slug}\n            {(userData.certification) && certificationIcon }\n            </h1>\n            </>\n          )}\n\n        {/* //! FROM HERE TO */}\n        {((logged) || (slug)) && (\n        <>    \n          <div className=\"user__header--link\">\n            http://wwww.soundclock.com/\n            {logged && userData.name } \n            {!logged && slug}\n          </div>\n          <div className=\"user__header--email\">\n            {logged && userData.email }             \n          </div>\n            <div className='user__header--data-container'>\n            <div className=\"user__header-h2\">Abonnés: \n              <span className=\"user__header-h2--stats\">\n                {(userLoaded) && userData.subscribers.length }\n              </span>\n            </div> \n            <div className=\"user__header-h2\">Musiques: \n              <span className=\"user__header-h2--stats\">\n                {(userLoaded) && userData.musics.length}\n              </span>\n            </div>  \n            <div className=\"user__header-h2\">Label: \n              <span className=\"user__header-h2--stats\">\n                {userData.label}\n              </span>\n            </div>       \n          </div>     \n        </>\n        )}\n        \n        {/* //! TO HERE useEffect loading error */}\n        </div>\n\n        {((logged) || (slug)) && (\n        \n          <div className=\"user__description\">\n          {userData.description}\n          </div>\n            \n        )}\n\n      </section>\n      \n    </section>\n\n    <section className=\"content-container\">\n\n    {/* Modal to Upload new content, only visible if logged in */}\n    {showModals &&\n    <>\n      <div className=\"content__addMusic--container\">\n        <ModalAddMusic \n          title={modalTitle}\n          file={modalFile}\n          picture={modalPicture}\n          releaseDate={modalReleaseDate}\n          description={modalDescription}\n          changeMusicField={changeMusicField}\n          handleAddMusic={handleAddMusic}\n          progress = {progressUpload}\n          errorCode= {errorCode}\n        />     \n      </div>\n    </>\n    }\n\n    {/* //! FROM HERE TO */}\n    {/* //* User Music section */}\n      <h1 className=\"content__section--title\">Music</h1>\n      <div className='content__section--container'>\n      {(userLoaded) && (\n        <>\n        {\n        musics.map((music) =>( \n          <Music\n            key={music.id}\n            name={music.title}\n            date={music.releaseDate}\n            image={music.picture}\n            description={music.description}\n            song={music.file}\n            nbLike={music.nbLike} \n            nbListened={music.nbListened} \n            baseApiUrl={baseApiUrl}   \n            />\n        ) ) \n        }\n        </>\n      )}\n      </div>\n\n    {/* //* Scrollbar hide placeholder */ }\n    <div className=\"content__section-container__placeholder\"></div>\n\n    {/* //* User Playlist section */}\n      <h1 className=\"content__section--title\">Playlists</h1>\n      <div className='content__section--container content__section--container-playlist'>\n      {(userLoaded) && (\n        <>\n        {\n          playlists.map((playlist) =>( \n          <Playlist\n            key={playlist.id}\n            name={playlist.title}\n            date={playlist.createdAt}\n            image={playlist.picture}\n            description={playlist.description}\n            nbLike={playlist.nbLike} \n            baseApiUrl={baseApiUrl}   \n            />\n        ) ) \n        }\n        </>\n      )}\n      </div>  \n\n    {/* //* Scrollbar hide placeholder */ }\n    <div className=\"content__section-container__placeholder\"></div>\n    \n  {/* //! TO HERE useEffect loading issue */}\n      \n    </section>\n\n  </div>\n\n  );\n\n};\n\nUser.propTypes = {\n  avatar: PropTypes.string.isRequired,\n}\n\n\nexport default User;"]},"metadata":{},"sourceType":"module"}